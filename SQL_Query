--I started off my checking to see the top 10 best selling games.

SELECT *
FROM game_sales
ORDER BY games_sold desc
LIMIT 10

--I used a Left Join with the Reviews table to gain more insight on the data to see how much of the data is null.
--I found that less than 10% of the data is null which is okay to continue my calculations.

SELECT COUNT(g.game)
FROM game_sales g
LEFT JOIN reviews r
ON g.game = r.game
WHERE critic_score IS NULL AND user_score IS NULL;

--I now want to calculate the top 10 average critic score and rounded it to 2 decimal points. This will help me get closer to finding out the Golden Age of video games.
--I used an Inner Join with the reviews to pull only data that matches both game_sales table and reviews table.
--I want to group by the year and order the average critic scores from highest to lowest.

SELECT g.year, ROUND(AVG(r.critic_score), 2) AS avg_critic_score
FROM game_sales g
INNER JOIN reviews r
ON g.game = r.game
GROUP by g.year
ORDER BY avg_critic_score desc
LIMIT 10


--After running this query the year 1982 came up to be one of highest average critic score at a 9, which is round for an average so I am thinking there weren't a lot of games released that year.
--To update my query I filtered the years based on four or more games released per year to see if 1982 is truly a great year for video games.

SELECT g.year,  ROUND(AVG(r.critic_score), 2) AS avg_critic_score, COUNT(g.game) AS num_games
FROM game_sales g
INNER JOIN reviews r
ON g.game = r.game
GROUP by g.year
HAVING COUNT(g.game) > 4
ORDER BY avg_critic_score desc
LIMIT 10

--The num_games column convinces us that our new list of the critics' top games reflects years that had quite a few well-reviewed games rather than just one or two hits. 
--Now I want to idently which years were dropped due to having four or less reviewed games.
--I'm going to identify them so that maye one day I can trach down more game reviews for those years and determine if they are to be be considered as great years for video game releases.
-- Select the year and avg_critic_score for those years that dropped off the list of critic favorites 
-- Order the results from highest to lowest avg_critic_score

SELECT year, avg_critic_score
FROM top_critic_years
EXCEPT
SELECT year, avg_critic_score
FROM top_critic_years_more_than_four_games
ORDER BY avg_critic_score DESC


